{% extends 'base.html' %}
{% load static i18n %}
{% block extra_css %}
<style>
  .infografik::-webkit-scrollbar {
    height: 8px;
  }
  .infografik::-webkit-scrollbar-thumb {
    background: #93c5fd;
    border-radius: 9999px;
  }

</style>

{% endblock %}
{% block content %}


<!-- HERO -->
<section id="hero" class="hero bg-red-50 p-8 text-center">
  <div class="relative">
    <div class="swiper hero-swiper">
      <div class="swiper-wrapper">
        {% for slide in sliders %}
        <a href="{{ slide.link|default:'#' }}" target="_blank" class="swiper-slide relative h-[400px] bg-cover bg-center block"
           style="background-image: url('{{ slide.image.url }}')">
          <div class="absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-center px-4 hover:bg-opacity-60 transition">
            <div class="text-white">
              <h2 class="text-3xl md:text-5xl font-bold mb-2">{{ slide.title }}</h2>
              <p class="text-lg md:text-xl">{{ slide.subtitle }}</p>
            </div>
          </div>
        </a>
        {% endfor %}
      </div>
      <br><br>
    <div class="swiper-pagination mt-4"></div>
    </div>
  </div>
</section>


<!-- BURS PROGRAMLARI -->
<section id="burs-programlari" class="py-12 bg-white">
  <div class="max-w-7xl mx-auto px-4">
    <h2 class="text-3xl font-bold text-center text-red-700 mb-8">{% trans "Burs Programları" %}</h2>
    <p class="text-center text-gray-600 mb-12">
      {% trans "Hayalini gerçekleştirmek için bir adım at. Sana uygun burs programını keşfet!" %}
    </p>

    <div class="flex flex-wrap justify-center gap-6">
      {% for scholarship in scholarships %}
      <a href="{% url 'scholarship_program_detail' slug=scholarship.slug %}"
         class="w-full sm:w-[45%] md:w-[30%] lg:w-[22%] xl:w-[18%] group bg-white border-2 border-red-300 hover:border-red-500 hover:shadow-lg transition rounded-xl p-6 text-center flex flex-col items-center justify-between">
        <img src="{{ scholarship.image.url }}" alt="{{ scholarship.title }}" class="w-16 h-16 object-contain mb-4 group-hover:scale-105 transition">
        <h3 class="text-lg font-bold text-red-700 mb-2">{{ scholarship.title }}</h3>
        <p class="text-sm text-gray-600">{{ scholarship.description|truncatewords:20|safe }}</p>
      </a>
      {% endfor %}
    </div>
  </div>
</section>


<!-- INFOGRAFIK: BAŞVURU SÜRECİ -->
<section id="basvuru-sureci" class="infografik p-8 text-center bg-red-50">
  <h2 class="text-3xl font-bold text-center text-red-700 mb-8">{% trans "Başvuru Süreci" %}</h2>
  <div class="flex flex-wrap justify-center gap-6">
    {% for step in infographic_steps %}
    <div class="w-52 h-52 bg-white border-2 border-red-300 hover:border-red-500 hover:shadow-lg rounded-full p-6 flex flex-col items-center justify-center text-center transition">
      <img src="{{ step.icon.url }}" alt="{{ step.title }}" class="w-12 h-12 mb-4">
      <h3 class="text-md font-bold text-red-700">{{ step.title }}</h3>
      <p class="text-sm text-gray-600 mt-1">{{ step.description }}</p>
    </div>
    {% endfor %}
  </div>
</section>

<!-- BAŞARI HİKAYELERİ -->
<section id="basari-hikayeleri" class="carousel p-8">
  <h2 class="text-3xl font-bold text-center text-red-700 mb-8">{% trans "Başarı Hikayeleri" %}</h2>
  <div class="swiper stories-swiper">
    <div class="swiper-wrapper">
      {% for story in stories %}
      <a href="{% url 'story_detail' story.slug %}" class="swiper-slide group border-2 border-red-300 hover:border-red-500 hover:shadow-lg transition rounded-xl p-6 text-center flex flex-col items-center justify-between">
        <img src="{{ story.image.url }}" class="h-40 w-full object-cover mb-4 rounded-xl">
        <h4 class="text-lg font-bold text-red-700 mb-2">{{ story.title }}</h4>
        <p class="text-sm text-gray-600">{{ story.content|truncatewords:25 }}</p>
      </a>
      {% endfor %}
    </div>
    <div class="swiper-button-prev news-prev"></div>
    <div class="swiper-button-next news-next"></div>
    <div class="swiper-pagination news-pagination mt-2"></div>
  </div>
</section>

<!-- TESTIMONIAL -->
<section id="yorumlar" class="testimonial p-8 bg-red-50">
  <div class="max-w-7xl mx-auto">
    <div class="flex flex-col sm:flex-row justify-between items-center mb-8 gap-4">
      <h2 class="text-3xl font-bold text-center text-red-700 sm:text-left">{% trans "Bursiyerlerimiz Ne Diyor?" %}</h2>
      <a href="{% url 'testimonials' %}#yorum-birak"
         class="inline-block bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded transition">
        {% trans "Yorum Yap" %}
      </a>
    </div>

    <div class="swiper testimonials-swiper">
      <div class="swiper-wrapper">
        {% for t in testimonials %}
        <div class="swiper-slide h-[340px] w-full sm:w-[300px] group border-2 border-red-300 hover:border-red-500 hover:shadow-lg transition rounded-xl p-6 text-center flex flex-col items-center justify-between">
          {% if t.profile_image %}
          <img src="{{ t.profile_image.url }}" class="w-24 h-24 rounded-full mb-4 object-cover">
          {% else %}
          <img src="{% static 'main/img/avatar.png' %}" class="w-24 h-24 rounded-full mb-4 object-cover">
          {% endif %}
          <p class="text-sm text-gray-600 mb-2">"{{ t.content|truncatewords:20 }}"</p>
          <small class="text-red-700 font-medium mt-auto">- {{ t.name }} {{ t.surname }}</small>
        </div>
        {% endfor %}
      </div>
      <div class="swiper-button-prev testimonial-prev"></div>
      <div class="swiper-button-next testimonial-next"></div>
      <div class="swiper-pagination testimonial-pagination mt-2"></div>
    </div>
  </div>
</section>


<!-- HABERLER -->
<section id="haberler" class="haberler p-8 bg-white">
  <h2 class="text-3xl font-bold text-center text-red-700 mb-8">{% trans "Son Haberler" %}</h2>
  <div class="swiper news-swiper">
    <div class="swiper-wrapper">
      {% for h in news %}
        <div class="swiper-slide">
          <a href="{% url 'news_detail' h.slug %}" class="group h-[400px] flex flex-col justify-between border-2 border-red-300 hover:border-red-500 hover:shadow-lg transition rounded-xl p-6 text-center">
            <img src="{{ h.image.url }}" class="w-full h-32 object-cover mb-4 rounded-md">
            <div>
              <h4 class="text-lg font-bold text-red-700 mb-1">{{ h.title }}</h4>
              <p class="text-sm text-gray-600 mb-2">{{ h.content|truncatewords:15 }}</p>
            </div>
            <small class="text-sm text-gray-400 mt-auto">{{ h.date|date:"d M Y" }}</small>
          </a>
        </div>
      {% endfor %}
    </div>
    <div class="swiper-button-prev news-prev"></div>
    <div class="swiper-button-next news-next"></div>
    <div class="swiper-pagination news-pagination mt-2"></div>
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    function initSwiper(selector, customConfig = {}) {
      const container = document.querySelector(selector);
      const slides = container?.querySelectorAll('.swiper-slide') || [];
      const slideCount = slides.length;

      const pagination = container.querySelector('.swiper-pagination');
      const next = container.querySelector('.swiper-button-next');
      const prev = container.querySelector('.swiper-button-prev');

      // Eğer 4 veya daha az kart varsa
      if (slideCount <= 4) {
        // Slide sayısına göre gösterim ayarı yap
        const config = {
          slidesPerView: slideCount,
          spaceBetween: 20,
          allowTouchMove: false, // kaydırma kapalı
        };

        pagination?.classList.add('hidden');
        next?.classList.add('hidden');
        prev?.classList.add('hidden');

        new Swiper(selector, { ...config, ...customConfig });
      } else {
        // Normal responsive swiper
        const config = {
          loop: false,
          spaceBetween: 20,
          pagination: {
            el: pagination,
            clickable: true
          },
          navigation: {
            nextEl: next,
            prevEl: prev
          },
          breakpoints: {
            320: { slidesPerView: 1 },
            640: { slidesPerView: 2 },
            1024: { slidesPerView: 3 },
            1280: { slidesPerView: 4 }
          },
        };

        new Swiper(selector, { ...config, ...customConfig });
      }
    }

    // Swiper'ları başlat
    initSwiper('.stories-swiper');
    initSwiper('.testimonials-swiper');
    initSwiper('.news-swiper');
    new Swiper('.hero-swiper', {
      loop: true,
      autoplay: {
        delay: 5000,
        disableOnInteraction: false,
      },
      effect: 'fade',
      pagination: {
        el: '.swiper-pagination',
        clickable: true,
      },
    });

  });
</script>


{% endblock %}

