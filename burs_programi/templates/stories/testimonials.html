{% extends 'base.html' %}
{% load i18n static %}
{% block title %}{% trans "Bursiyerlerimizin Gözünden" %}{% endblock %}
{% block content %}

<style>
  input[type="text"],
  textarea,
  input[type="file"] {
    width: 100%;
    padding: 0.5rem 0.75rem;
    border: 1px solid #d1d5db;
    border-radius: 0.5rem;
    outline: none;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
  }

  input[type="text"]:focus,
  textarea:focus {
    border-color: #dc2626;
    box-shadow: 0 0 0 2px rgba(220, 38, 38, 0.5);
  }

  textarea {
    resize: vertical;
    min-height: 120px;
  }

  input[type="file"] {
    display: none;
  }
</style>

<h1 class="text-3xl font-bold text-center text-red-700 sm:text-center">{% trans "Bursiyerlerimizin Gözünden" %}</h1>
<br><br>

<!-- Interviews -->
<section class="mb-12">
  <h2 class="text-3xl font-bold text-center text-red-700 sm:text-center">{% trans "Video Röportajlar" %}</h2>

  <div class="swiper interviews-swiper">
    <div class="swiper-wrapper">
      {% for video in interviews %}
      <div class="swiper-slide p-4">
        <div class="bg-red-50 p-4 rounded shadow">
          <h3 class="font-bold mb-2 text-center text-red-700">{{ video.title }}</h3>
          <div class="aspect-w-16 aspect-h-9">
            <iframe class="w-full h-60" src="{{ video.embed_url }}" frameborder="0" allowfullscreen></iframe>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    <div class="swiper-pagination mt-4"></div>
    <div class="swiper-button-prev"></div>
    <div class="swiper-button-next"></div>
  </div>
</section>

<!-- Success Stories -->
<section class="carousel p-8">
  <h2 class="text-3xl font-bold text-center text-red-700 mb-8">{% trans "Başarı Hikayeleri" %}</h2>
  <div class="swiper stories-swiper">
    <div class="swiper-wrapper">
      {% for story in stories %}
      <a href="{% url 'story_detail' story.slug %}" class="swiper-slide group border-2 border-red-300 hover:border-red-500 hover:shadow-lg transition rounded-xl p-6 text-center flex flex-col items-center justify-between">
        <img src="{{ story.image.url }}" class="h-40 w-full object-cover mb-4 rounded-xl">
        <h4 class="text-lg font-bold text-red-700 mb-2">{{ story.title }}</h4>
        <p class="text-sm text-gray-600">{{ story.content|truncatewords:25 }}</p>
      </a>
      {% endfor %}
    </div>
    <div class="swiper-button-prev"></div>
    <div class="swiper-button-next"></div>
    <div class="swiper-pagination mt-2"></div>
  </div>
</section>

<!-- Testimonials -->
<section class="testimonial p-8 bg-red-50">
  <div class="max-w-7xl mx-auto">
    <div class="flex flex-col sm:flex-row justify-between items-center mb-8 gap-4">
      <h2 class="text-3xl font-bold text-center text-red-700 sm:text-left">{% trans "Yorumlarınız" %}</h2>
    </div>
    <div class="swiper testimonials-swiper">
      <div class="swiper-wrapper">
        {% for t in testimonials %}
        <div class="swiper-slide h-[340px] w-full sm:w-[300px] group border-2 border-red-300 hover:border-red-500 hover:shadow-lg transition rounded-xl p-6 text-center flex flex-col items-center justify-between">
          {% if t.profile_image %}
          <img src="{{ t.profile_image.url }}" class="w-24 h-24 rounded-full mb-4 object-cover">
          {% else %}
          <img src="{% static 'main/img/avatar.png' %}" class="w-24 h-24 rounded-full mb-4 object-cover">
          {% endif %}
          <p class="text-sm text-gray-600 mb-2">"{{ t.content|truncatewords:20 }}"</p>
          <small class="text-red-700 font-medium mt-auto">- {{ t.name }} {{ t.surname }}</small>
        </div>
        {% endfor %}
      </div>
      <div class="swiper-button-prev"></div>
      <div class="swiper-button-next"></div>
      <div class="swiper-pagination mt-2"></div>
    </div>
  </div>
</section>

<!-- Yorum Formu -->
<section class="mt-12">
  <h2 id="yorum-birak" class="text-3xl font-bold text-center text-red-700 sm:text-center mb-6">
    {% trans "Yorum Bırak" %}
  </h2>

  <form method="post" enctype="multipart/form-data"
        class="bg-white p-6 rounded-xl shadow-md border border-red-200 space-y-6 max-w-3xl mx-auto">
    {% csrf_token %}
    {{ form.non_field_errors }}

    <div class="grid md:grid-cols-2 gap-6">
      <div>
        <label for="id_name" class="block font-medium text-red-700 mb-1">{{ form.name.label }}</label>
        {{ form.name }}
        {{ form.name.errors }}
      </div>
      <div>
        <label for="id_surname" class="block font-medium text-red-700 mb-1">{{ form.surname.label }}</label>
        {{ form.surname }}
        {{ form.surname.errors }}
      </div>
    </div>

    <div>
      <label for="id_content" class="block font-medium text-red-700 mb-1">{{ form.content.label }}</label>
      {{ form.content }}
      {{ form.content.errors }}
    </div>

    <div>
      <label for="id_profile_image" class="block font-medium text-red-700 mb-1">{{ form.profile_image.label }}</label>
      <label for="id_profile_image"
             class="inline-block px-4 py-2 bg-red-100 text-red-900 rounded cursor-pointer hover:bg-red-200 transition">
        {% trans "Dosya Seç" %}
      </label>
      <span id="file-name" class="ml-2 text-gray-700">{% trans "Dosya seçilmedi" %}</span>
      {{ form.profile_image }}
      {{ form.profile_image.errors }}
    </div>

    <button type="submit"
            class="bg-red-600 hover:bg-red-700 text-white font-semibold px-6 py-2 rounded transition">
      {% trans "Gönder" %}
    </button>
  </form>
</section>

<script>
  function updateFileName(input) {
    const fileName = input.files.length > 0 ? input.files[0].name : "{% trans 'Dosya seçilmedi' %}";
    document.getElementById("file-name").innerText = fileName;
  }
</script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const swiperSettings = {
      loop: false,
      spaceBetween: 20,
      slidesPerView: 1,
      breakpoints: {
        640: { slidesPerView: 1 },
        768: { slidesPerView: 2 },
        1024: { slidesPerView: 3 },
        1280: { slidesPerView: 4 }
      },
      pagination: {
        el: '.swiper-pagination',
        clickable: true
      },
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev'
      }
    };

    new Swiper('.interviews-swiper', swiperSettings);
    new Swiper('.testimonials-swiper', swiperSettings);
    new Swiper('.stories-swiper', swiperSettings);
  });
</script>

{% endblock %}
